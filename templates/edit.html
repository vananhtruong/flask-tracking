<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S·ª≠a s·∫£n ph·∫©m - Truy xu·∫•t Ngu·ªìn g·ªëc</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="{{ url_for('index') }}" class="navbar-brand">üå± Truy xu·∫•t Ngu·ªìn g·ªëc</a>
            <div class="navbar-actions">
                {% if user %}
                    <span style="color: var(--primary-color); font-weight: 600;">üë§ {{ user.full_name }}</span>
                    <a href="{{ url_for('profile') }}" class="btn btn-secondary btn-small">Th√¥ng tin</a>
                    <a href="{{ url_for('manage') }}" class="btn btn-secondary btn-small">Qu·∫£n l√Ω</a>
                    <a href="{{ url_for('logout') }}" class="btn btn-secondary btn-small">ƒêƒÉng xu·∫•t</a>
                {% else %}
                    <a href="{{ url_for('login') }}" class="btn btn-secondary btn-small">ƒêƒÉng nh·∫≠p</a>
                    <a href="{{ url_for('register') }}" class="btn btn-primary btn-small">ƒêƒÉng k√Ω</a>
                {% endif %}
            </div>
        </div>
    </nav>
    
    <div class="container">
        <header>
            <h1>‚úèÔ∏è S·ª≠a s·∫£n ph·∫©m</h1>
            <p class="subtitle">C·∫≠p nh·∫≠t th√¥ng tin s·∫£n ph·∫©m</p>
        </header>

        <main>
            <div class="form-container">
                {% if error %}
                <div class="alert alert-error">
                    ‚ö†Ô∏è {{ error }}
                </div>
                {% endif %}

                <form method="POST" action="{{ url_for('edit_product', product_id=product.id) }}" class="product-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="product_name">T√™n s·∫£n ph·∫©m <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="product_name" 
                            name="product_name" 
                            required 
                            value="{{ product.product_name }}"
                            placeholder="V√≠ d·ª•: L√∫a gi·ªëng ST25"
                            class="form-input"
                        >
                    </div>

                    <div class="form-group">
                        <label for="farmer_name">H·ªô n√¥ng d√¢n s·∫£n xu·∫•t <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="farmer_name" 
                            name="farmer_name" 
                            value="{{ product.farmer_name }}"
                            readonly
                            class="form-input"
                            style="background-color: #f5f5f5; cursor: not-allowed;"
                        >
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="planting_date">Ng√†y tr·ªìng</label>
                            <input 
                                type="date" 
                                id="planting_date" 
                                name="planting_date" 
                                value="{{ product.planting_date or '' }}"
                                class="form-input"
                            >
                        </div>

                        <div class="form-group">
                            <label for="harvest_date">Ng√†y thu ho·∫°ch</label>
                            <input 
                                type="date" 
                                id="harvest_date" 
                                name="harvest_date" 
                                value="{{ product.harvest_date or '' }}"
                                class="form-input"
                            >
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="production_area">Khu v·ª±c s·∫£n xu·∫•t</label>
                        <input 
                            type="text" 
                            id="production_area" 
                            name="production_area" 
                            value="{{ product.production_area or '' }}"
                            placeholder="V√≠ d·ª•: X√£ An Ph√∫, Huy·ªán C·∫ßn ƒê∆∞·ªõc, Long An"
                            class="form-input"
                        >
                    </div>

                    <div class="form-group">
                        <label for="production_process">Quy tr√¨nh s·∫£n xu·∫•t</label>
                        <textarea 
                            id="production_process" 
                            name="production_process" 
                            rows="5" 
                            placeholder="M√¥ t·∫£ quy tr√¨nh s·∫£n xu·∫•t, chƒÉm s√≥c..."
                            class="form-input"
                        >{{ product.production_process or '' }}</textarea>
                    </div>

                    {% if product.production_media %}
                    <div class="form-group">
                        <label>üì∏ Media qu√° tr√¨nh s·∫£n xu·∫•t hi·ªán c√≥</label>
                        <div class="media-preview">
                            {% for media in product.production_media %}
                                <div class="media-item">
                                    {% if media.endswith(('.mp4', '.mov', '.avi', '.mkv', '.webm')) %}
                                        <video controls style="max-width: 200px; max-height: 150px; border-radius: 8px;">
                                            <source src="{{ url_for('static', filename=media) }}" type="video/mp4">
                                        </video>
                                    {% else %}
                                        <img src="{{ url_for('static', filename=media) }}" alt="Production media" style="max-width: 200px; max-height: 150px; border-radius: 8px; object-fit: cover;">
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <div class="form-group">
                        <label for="production_files">üì∏ Th√™m Video/H√¨nh ·∫£nh qu√° tr√¨nh s·∫£n xu·∫•t</label>
                        <input 
                            type="file" 
                            id="production_files" 
                            name="production_files" 
                            multiple
                            accept="image/*,video/*"
                            class="form-input"
                        >
                        <small class="form-hint">C√≥ th·ªÉ ch·ªçn nhi·ªÅu file. H·ªó tr·ª£: JPG, PNG, GIF, MP4, MOV, AVI (t·ªëi ƒëa 100MB/file)</small>
                    </div>

                    <div class="form-group">
                        <label for="harvest_process">Qu√° tr√¨nh thu ho·∫°ch</label>
                        <textarea 
                            id="harvest_process" 
                            name="harvest_process" 
                            rows="5" 
                            placeholder="M√¥ t·∫£ qu√° tr√¨nh thu ho·∫°ch, ph∆∞∆°ng ph√°p thu ho·∫°ch, th·ªùi ƒëi·ªÉm thu ho·∫°ch..."
                            class="form-input"
                        >{{ product.harvest_process or '' }}</textarea>
                    </div>

                    {% if product.harvest_media %}
                    <div class="form-group">
                        <label>üì∏ Media qu√° tr√¨nh thu ho·∫°ch hi·ªán c√≥</label>
                        <div class="media-preview">
                            {% for media in product.harvest_media %}
                                <div class="media-item">
                                    {% if media.endswith(('.mp4', '.mov', '.avi', '.mkv', '.webm')) %}
                                        <video controls style="max-width: 200px; max-height: 150px; border-radius: 8px;">
                                            <source src="{{ url_for('static', filename=media) }}" type="video/mp4">
                                        </video>
                                    {% else %}
                                        <img src="{{ url_for('static', filename=media) }}" alt="Harvest media" style="max-width: 200px; max-height: 150px; border-radius: 8px; object-fit: cover;">
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <div class="form-group">
                        <label for="harvest_files">üì∏ Th√™m Video/H√¨nh ·∫£nh qu√° tr√¨nh thu ho·∫°ch</label>
                        <input 
                            type="file" 
                            id="harvest_files" 
                            name="harvest_files" 
                            multiple
                            accept="image/*,video/*"
                            class="form-input"
                        >
                        <small class="form-hint">C√≥ th·ªÉ ch·ªçn nhi·ªÅu file. H·ªó tr·ª£: JPG, PNG, GIF, MP4, MOV, AVI (t·ªëi ƒëa 100MB/file)</small>
                    </div>

                    <div class="form-group">
                        <label for="storage_method">C√°ch b·∫£o qu·∫£n</label>
                        <textarea 
                            id="storage_method" 
                            name="storage_method" 
                            rows="5" 
                            placeholder="M√¥ t·∫£ c√°ch b·∫£o qu·∫£n s·∫£n ph·∫©m, nhi·ªát ƒë·ªô, ƒë·ªô ·∫©m, th·ªùi gian b·∫£o qu·∫£n..."
                            class="form-input"
                        >{{ product.storage_method or '' }}</textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-large">
                            üíæ L∆∞u thay ƒë·ªïi
                        </button>
                        <a href="{{ url_for('manage') }}" class="btn btn-secondary">H·ªßy</a>
                    </div>
                </form>
            </div>
        </main>

        <footer>
            <a href="{{ url_for('manage') }}" class="btn btn-link">‚Üê Quay l·∫°i qu·∫£n l√Ω s·∫£n ph·∫©m</a>
        </footer>
    </div>
</body>
</html>

